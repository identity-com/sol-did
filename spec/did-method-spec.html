<!DOCTYPE html>
<html>
<head>
  <meta charset='utf-8'>
  <title>SOLID DID Method Specification</title>
  <style>
    #instructions {
      border: dashed 1px black;
      padding: 1em;
      background-color:#d0d0d0;
    }
    .replace-me {
      font-style:italic;
      color:magenta
    }
  </style>
  <script
    src='https://www.w3.org/Tools/respec/respec-w3c'
    class='remove'></script>
  <script class='remove'>
    var respecConfig = {
      specStatus: "ED",
      editors: [{
        name: "Daniel Kelleher",
        url: "https://identity.com",
      }
      ],
      processVersion: 2017,
      edDraftURI: "https://github.com/identity-com/solid-did",
      shortName: "SOLID"
    };
  </script>
</head>
<body>
<section class="introductory">
  <h2>About</h2>
  <p>The SOLID DID method specification conforms to the requirements specified in the DID specification
    currently published by the W3C Credentials Community Group. For more information about DIDs and
    DID method specifications, please see the <a
      href="https://github.com/WebOfTrustInfo/rebooting-the-web-of-trust-fall2017/blob/master/topics-and-advance-readings/did-primer.md"
      target="_blank">DID Primer</a> and <a href="https://w3c-ccg.github.io/did-spec/">DID Spec</a>.</p>
</section>
<section id='abstract'>
  <p>
    Solana is a high-speed, low-fee public ledger based on a novel Proof-of-History consensus network.
    The SOLID DID method is a method for storing DIDs and managing DID documents on Solana.
  </p>
</section>
<section id='sotd'>
  <p>&nbsp;
  </p>
</section>
<section>
  <h2>SOLID DID Method </h2>
  <p>The namestring that shall identify this DID method is: <code>solid</code></p>
  <p>A DID that uses this method MUST begin with the following prefix: <code>did:solid</code>.
    Per the DID specification, this string MUST be in lowercase. The remainder of the DID, after the prefix,
    is the NSI specified below.</p>
</section>
<section>
  <h2>Target System(s)</h2>
  <p>This DID method applies to the Solana mainnet network as well as the testnet and devnet clusters.</p>
</section>
<section>
  <h2>Namespace Specific Identifier (NSI)</h2>
  <p>
    The SOLID DID scheme is defined by the following <a href="ftp://ftp.rfc-editor.org/in-notes/std/std68.txt">ABNF</a>:<br><br>
    <code>
      solid-did    = "did:solid" *(":" network) ":" idstring<br>
      idstring      = 40*48(base58char)<br>
      network  = "testnet" / "devnet" / "development" <br>
      base58char          = "1" / "2" / "3" / "4" / "5" / "6" / "7" / "8" / "9" / "A" / "B" / "C"<br/>
      &nbsp;&nbsp;&nbsp;&nbsp;/ "D" / "E" / "F" / "G" / "H" / "J" / "K" / "L" / "M" / "N" / "P" / "Q"<br/>
      &nbsp;&nbsp;&nbsp;&nbsp;/ "R" / "S" / "T" / "U" / "V" / "W" / "X" / "Y" / "Z" / "a" / "b" / "c"<br/>
      &nbsp;&nbsp;&nbsp;&nbsp;/ "d" / "e" / "f" / "g" / "h" / "i" / "j" / "k" / "m" / "n" / "o" / "p"<br/>
      &nbsp;&nbsp;&nbsp;&nbsp;/ "q" / "r" / "s" / "t" / "u" / "v" / "w" / "x" / "y" / "z"<br>
    </code><br>
    All SOLID DIDs are base58 encoded using the Bitcoin/IPFS alphabets of a 32-byte key.
    The encoding uses most alphas and digits, omitting 0OIl to avoid readability problems. This
    gives an NSI length of between 40 and 48 characters, and it means that DIDs are case-sensitive and may not
    be case-normalized, even though the prefix is always lower-case.<br>
    <br>
    Optionally, a network may be specified to indicate which Solana cluster contains the DID document.
  </p>
  <h3>Identifier Generation Method</h3>
  <p>The 32-byte key underlying a SOLID DID is generated from the following deterministic algorithm.
    Given a DID owner with a public key on the x25519 ECC Curve, the DID owner key, the DID method ("solid"), a
    "bump seed", and the Solana program ID are hashed together.
  </p><p>
  The "bump seed" ensures the resultant address
  does not clash with the account address space, which lie on the Curve25519
  elliptic curve.
</p><p>
  The program ID is <code>ide3Y2TubNMLLhiG1kDL6to4a8SjxD18YWCYC5BZqNV</code> on all networks.
</p><p>
  The bump seed is deterministically derivable off-chain as follows:
</p><p>
  <pre>
    Initialize the seed to 256 (2^8)
    Do:
      Decrement the seed by 1
      Hash the owner address, DID method, seed, and program ID
    While the resultant point is on the Curve25519 curve
  </pre>
</p>
  <p>A convenient regex to match <code>SOLID</code> DID identifiers is: <br><br>
    <code>^[1-9A-HJ-NP-Za-km-z]{40,48}$</code><br><br>
    A convenient regex to match the entire DID string is:<br><br>
    <code>^did\:solid(\:(testnet|devnet|development))?\:[1-9A-HJ-NP-Za-km-z]{40,48}$</code>
  </p>
  <h3>Examples</h3>
  <p>Valid <code>SOLID</code> DIDs might be:
    <ul>
  <li><code>did:solid:FcFhBFRf6smQ48p7jFcE35uNuE9ScuUu6R2rdFtWjWhP</code></li>
  <li><code>did:solid:devnet:5EK2qdAp2xgNGRS7UZjFPBoJmUK3GyrxCwNsApD3JYwt</code></li>
  </ul></p>
</section>
<section>
  <h2>Operations</h2>
  The following section outlines the DID operations for the did:solid method.
  <h3>Create (Register)</h3>
  <p>
    Creating a SOLID DID involves submitting a transaction to the Solana blockchain calling the "Initialize" instruction
    on the SOLID Program. The only required input to this program is the public key of the 'authority', that is, the
    initial owner of the DID. This creates a 'sparse' DID Document as follows:
<pre>
{
        "@context": [
            "https://w3id.org/did/v1.0",
            "https://w3id.org/solid/v1"
        ],
        "id": "did:solid:IDENTIFIER",
        "verificationMethod": [
            {
                "id": "did:solid:IDENTIFIER#key1",
                "type": "Ed25519VerificationKey2018",
                "controller": "did:solid:IDENTIFIER",
                "publicKeyBase58": "AUTHORITY"
            }
        ],
        "authentication": [
            "did:solid:IDENTIFIER#key1"
        ],
        "assertionMethod": [],
        "keyAgreement": [],
        "capabilityInvocation": [
            "did:solid:IDENTIFIER#key1"
        ],
        "capabilityDelegation": [],
        "service": [],
        "publicKey": [
            {
                "id": "did:solid:IDENTIFIER#key1",
                "type": "Ed25519VerificationKey2018",
                "controller": "did:solid:IDENTIFIER",
                "publicKeyBase58": "AUTHORITY"
            }
        ]
    }
</pre>
  where: </p><p>
  <code>AUTHORITY</code> is the base58-encoded 32-byte x25519 public key of the DID owner,</p><p>
  <code>IDENTIFIER</code> is the DID method identifier derived from the authority.</p><p>

  The transaction must be signed by the authority.
  </p><p>An optional additional SolidData field may be added, containing additional document data, such as service
  endpoints or additional keys.
  </p>

  <h3>Read (Resolve)</h3>
  <p>A SOLID DID record can be looked up on Solana,by stripping the did:solid: prefix from the DID, and
    network identifier if present, and looking up the account on-chain.</p>
  <p>Anyone can query a DID record, by sending the above request. The response contains the DID document .</p>
  <p></p>
  <pre>
        </pre>

  <h3>Update (Replace)</h3>
  <p>To replace the DID document, the owner or guardian (guardianship ends once ownership begins) of the DID should send the following
    transaction using a key referenced in the <strong>authentication</strong> property.
  <pre>
                  {
                    "submitterId": &lt;DID of the author of this query&gt;,
                    "signature": [&lt;signature over this transaction from the author&gt;,]
                    "reqId": &lt;a nonce for this query&gt;,
                    "operation": {
                        "type": "NYM",
                        "did": &lt;DID whose record needs to be updated&gt;,
                        "document": {
                            "publicKey": [{
                                "id": &lt;a valid unique identifier&gt;
                                "type": &lt;ED25519&gt;
                                "publicKeyBase58": &lt;Key material encoded in format&gt;,
                                "authorizations": ["all"]
                            },{
                                "id": &lt;a valid unique identifier&gt;
                                "type": &lt;ED25519&gt;
                                "publicKeyBase58": &lt;Key material encoded in format&gt;
                            },{
                                "id": &lt;a valid unique identifier&gt;
                                "type": &lt;ED25519&gt;
                                "publicKeyBase58": &lt;Key material encoded in format&gt;
                            }],
                            "authentication": [{
                                "type": "ED25519SigningAuthenticationThreshold",
                                "threshold": &lt;an integer&gt;,
                                "publicKey": [&lt;key references&gt;]
                            }],
                            "service": [{
                              "type": &lt;agentService, emailService, apiService, dnsService, authenticationService, etc&gt;,
                              "serviceEndpoint": &lt;A URI for the endpoint&gt;
                            }]
                        }
                      }
                  }
                </pre>
  <br/>
  This example shows how to update the DID document to require multiple signatures for authentication:
  <pre>
                {
                    "submitterId": "did:solid:qazWSX3erfcY459iLMh7",
                    "signature": ["1qaz2wsx3eeciguytGGVDR990ik=="]
                    "reqId": "897432983746n43g"
                    "operation": {
                        "type": "NYM",
                        "did": "did:solid:c432cDSGUASJN987jnJKb",
                        "document": {
                            "publicKey": [{
                                "id": "#key1",
                                "type": "ED25519VerificationKey",
                                "publicKeyBase58": ...
                            },{
                                "id": "#key2",
                                "type": "ED25519VerificationKey",
                                "publicKeyBase58": ...
                            },{
                                "id": "#key3",
                                "type": "ED25519VerificationKey",
                                "publicKeyBase58": ...
                            }],
                            "authentication": [{
                                "type": "ED25519SigningAuthenticationThreshold",
                                "threshold": 2,
                                "publicKey": ["#key1","#key2","#key3"]
                            }],
                            "service": [{
                              "type": "agentService",
                              "serviceEndpoint": "https://www.SOLID.org/agents"
                            }]
                        }
                      }
                  }
                </pre>
  </p>

  <h3>Delete (Revoke)</h3>
  <p>Deleting or revoking a verification key is not to be confused with temporary suspension or rotation. Deletion
    sets an identity's verification key to null; this permanently terminates the identity's ability to operate
    on the network because there is no key that the identity can use to authenticate itself--even to submit a
    new key rotation request. It is irreversible.</p>
  <p>Revocation may be appropriate
    when a person dies or a business is legally dissolved. It does not remove any record or history of the
    identity--it simply prevents any new history from accruing. This guarantees that
    no malicious actor can recover and reactivate an identity that's dead.</p>
  <p>The scope of deletion in SOLID is one DID only. This does not prevent an entity from creating new DIDs;
    it simply prevents an entity from reusing the old DID that has been terminated.</p>
  <p> To revoke the document of the DID, the owner of
    the DID should send the following transaction.
  <pre>
                {
                    "submitterId": &lt;DID of the owner&gt;,
                    "signature": &lt;signature over this transaction from the DID in identifier&gt;,
                    "reqId": &lt;a nonce for this transaction&gt;,
                    "operation": {
                        "type": "NYM",
                        "did": &lt;DID whose key is being revoked&gt;,
                        "document": null
                    }
                }
            </pre>
  </p>
</section>

<section>
  <h2>Security Considerations</h2>
  <h3>Attacks</h3>
  <p>Secure communication to the SOLID Ledger uses <a href="http://curvezmq.org">CurveZMQ</a> to mitigate attacks like eavesdropping, replay, message insertion, deletion, modification, impersonation, and man-in-the-middle. Any vulnerabilities in that protocol will apply to SOLID.</p>
  <p>SOLID uses a modified version of the Redundant Byzantinne Fault Tolerace protocol called <a href="https://github.com/hyperledger/indy-plenum/wiki">Plenum</a> to reach consensus.</p>

  <p>SOLID currently stores only the following data on the ledger:
  <ul>
    <li>Public DIDs/DID Documents which includes: public keys and service endpoints</li>
    <li>Credential Schemas</li>
    <li>Credential Definitions – the use of a specific Schema, by a specific DID for the purpose of issuing credentials and a reference to a Revocation Registry</li>
    <li>Revocation Registries associated with Credential Definitions</li>
    <li>Policy Registries – used for authorizing agents and a reference to a Policy Accumulator.</li>
    <li>Policy Accumulators – proving authorizing agents in zero knowledge.</li>
  </ul>
  All confidential information such as cryptographic private keys are stored with end consumers of SOLID.
  </p>

  <h3>Residual Risks</h3>
  <p>We don't believe to have any residual risks at this time.</p>

  <div class="replace-me">
    <h3>Recovery From Key Compromise</h3>

    <p>This section MUST provide integrity protection and update authentication for all operations required by Section 7 of this specification (DID Operations).</p>

    <p><a href="https://en.wikipedia.org/wiki/Confused_deputy_problem" target="_blank">Confused Deputy Problem</a> when attempting separation of writeAuthorization from authenticationCredential.</p>
    <p>Other sections from DID spec to incorporate into the outline:</p>
  </div>
</section>

<section>
  <h2>Privacy Considerations</h2>
  <div>
    Assume psuedonymous DID. What SOLID is doing about privacy and addresses each of these.
    <p>Considering <a href="http://www.lifewithalacrity.com/2015/04/the-four-kinds-of-privacy.html" target="_blank">all
      four types of privacy</a>, explore issues from these sections of the DID spec:</p>

    <pre style="color:magenta">
            10. Privacy Considerations
            10.1 Requirements of DID Method Specifications
            10.2 Keep Personally-Identifiable Information (PII) Off-Ledger
            10.3 DID Correlation Risks and Pseudonymous DIDs
            10.4 Document Correlation Risks
            10.5 Herd Privacy
            </pre>
  </div>
</section>

<section>
  <h2>Reference Implementations</h2>
  The code at <a href="https://github.com/hyperledger/indy-node/tree/stable" target="_blank">https://github.com/hyperledger/indy-node, stable</a>
  and <a href="https://github.com/hyperledger/indy-sdk/tree/master" target="_blank">https://github.com/hyperledger/indy-sdk, master</a>
  constitute a canonical implementation of SOLID DIDs, and should be treated like an oracle.
  <p>Note that the code includes a test suite; any other implementations should ensure that all tests pass before they claim compatibility.</p>
</section>

<section>
  <h2>Resources</h2>
  <p>Many developers maintaining the code and spec tend to hang out in RocketChat at chat.hyperledger.org, #indy and #indy-sdk.
    You might also connect with us in Hyperledger and W3C working groups or at the semi-annual Internet Identity Workshop conferences.</p>
</section>
<section id='conformance'></section>
</body>
</html>
